{% extends "base.html" %}
{% block title %}Process Observation{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">
            <i class="fas fa-camera me-2"></i>Process Observation
        </h1>
        <!-- Scheduled Report Alert -->
        {% if session.get('scheduled_child_id') %}
        <div class="alert alert-info alert-dismissible fade show">
            <i class="fas fa-clock me-2"></i>
            <strong>Scheduled Report:</strong> Processing report for {{ session.get('scheduled_child_name') }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endif %}
    </div>
</div>

<div class="row">
    <!-- Main Processing Area -->
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-cogs me-2"></i>Create New Observation Report</h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('observer.process_file') }}" enctype="multipart/form-data" id="process-form">
                    <!-- Child Selection -->
                    <div class="mb-4">
                        <label for="child_id" class="form-label">Select Child</label>
                        <select class="form-select" id="child_id" name="child_id" required>
                            <option value="">Choose a child</option>
                            {% for child in children %}
                            <option value="{{ child.id }}">{{ child.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <!-- Processing Mode Selection -->
                    <div class="mb-4">
                        <label class="form-label">Processing Mode</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="processing_mode" id="ocr_mode" value="ocr">
                            <label class="btn btn-outline-primary" for="ocr_mode">
                                <i class="fas fa-image me-2"></i>OCR (Image Upload)
                            </label>

                            <input type="radio" class="btn-check" name="processing_mode" id="audio_mode" value="audio">
                            <label class="btn btn-outline-success" for="audio_mode">
                                <i class="fas fa-microphone me-2"></i>Audio Upload
                            </label>
                        </div>
                    </div>

                    <!-- Session Information -->
                    <div class="mb-4">
                        <h6>Session Information</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="student_name" class="form-label">Student Name</label>
                                    <input type="text" class="form-control" id="student_name" name="student_name" placeholder="Student name">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="session_date" class="form-label">Session Date</label>
                                    <input type="date" class="form-control" id="session_date" name="session_date" value="{{ today_date }}">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="session_start" class="form-label">Start Time</label>
                                    <input type="time" class="form-control" id="session_start" name="session_start">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="session_end" class="form-label">End Time</label>
                                    <input type="time" class="form-control" id="session_end" name="session_end">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- File Upload Area -->
                    <div id="upload-section" class="mb-4" style="display: none;">
                        <div class="file-upload-area" onclick="document.getElementById('file-input').click()">
                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Click to upload or drag and drop</p>
                            <p class="text-muted small" id="file-types">Select a processing mode first</p>
                        </div>
                        <input type="file" id="file-input" name="file" class="d-none">
                        <div id="file-preview" class="mt-3"></div>
                    </div>

                    <!-- Process Button -->
                    <button id="process-btn" class="btn btn-primary btn-lg w-100" disabled type="submit">
                        <i class="fas fa-play me-2"></i>Process Observation
                    </button>
                </form>
            </div>
        </div>

        <!-- Generated Report Display -->
        {% if last_report %}
        <div class="card mt-4" id="generated-report">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-file-alt me-2"></i>Generated Report</h5>
                <div class="btn-group">
                    <a href="{{ url_for('observer.download_report') }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-download me-1"></i>Download Word
                    </a>
                    <a href="{{ url_for('observer.download_pdf') }}" class="btn btn-outline-danger btn-sm">
                        <i class="fas fa-file-pdf me-1"></i>Download PDF
                    </a>
                    <button class="btn btn-outline-success btn-sm" onclick="showEmailModal('regular')">
                        <i class="fas fa-envelope me-1"></i>Email
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="report-content" style="white-space: pre-wrap; background: #f8f9fa; padding: 1rem; border-radius: 8px; max-height: 500px; overflow-y: auto; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6;">
                    {{ last_report }}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Custom Report Section -->
        <div class="card mt-4">
            <div class="card-header">
                <h5><i class="fas fa-magic me-2"></i>Generate Custom Report</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="custom-child-select" class="form-label">Select Child</label>
                    <select class="form-select" id="custom-child-select">
                        <option value="">Choose a child</option>
                        {% for child in children %}
                        <option value="{{ child.id }}">{{ child.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="mb-3">
                    <label for="custom-prompt" class="form-label">Report Prompt</label>
                    <textarea class="form-control" id="custom-prompt" rows="3"
                              placeholder="Describe what kind of report you want to generate based on stored observation data..."></textarea>
                </div>
                <button class="btn btn-success" onclick="generateCustomReport()">
                    <i class="fas fa-magic me-2"></i>Generate Custom Report
                </button>
            </div>
        </div>

        <!-- FIXED: Custom Report Display with Download and Email Buttons -->
        <div id="custom-report-section" class="card mt-4" style="display: none;">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5><i class="fas fa-magic me-2"></i>Custom Report</h5>
                <div class="btn-group">
                    <button class="btn btn-outline-primary btn-sm" onclick="downloadCustomReport('word')">
                        <i class="fas fa-download me-1"></i>Download Word
                    </button>
                    <button class="btn btn-outline-danger btn-sm" onclick="downloadCustomReport('pdf')">
                        <i class="fas fa-file-pdf me-1"></i>Download PDF
                    </button>
                    <button class="btn btn-outline-success btn-sm" onclick="emailCustomReport()">
                        <i class="fas fa-envelope me-1"></i>Email
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div id="custom-report-content" style="white-space: pre-wrap; background: #f8f9fa; padding: 1rem; border-radius: 8px; max-height: 500px; overflow-y: auto; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6;"></div>
            </div>
        </div>
    </div>

        <!-- Right Column: Topic Suggestions -->
        <div class="col-lg-4 col-md-12">
            <div class="card shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">ðŸ’¡ AI Topic Suggestions</h5>
                </div>
                <div class="card-body">
                    <div id="suggestionsContainer">
                        <div class="text-center text-muted py-4">
                            <i class="fas fa-lightbulb fa-2x mb-3"></i>
                            <p>Select a child to get AI-powered topic suggestions based on their learning history!</p>
                        </div>
                    </div>

                    <!-- Suggestions Controls -->
                    <div id="suggestionsControls" style="display: none;" class="mt-3">
                        <div class="d-grid gap-2">
                            <button type="button" id="getSuggestionsBtn" class="btn btn-info btn-sm">
                                <i class="fas fa-magic me-1"></i>Get Suggestions
                            </button>
                            <button type="button" id="refreshSuggestionsBtn" class="btn btn-outline-info btn-sm">
                                <i class="fas fa-sync-alt me-1"></i>Refresh Ideas
                            </button>
                        </div>
                    </div>

                    <!-- Loading Indicator -->
                    <div id="suggestionsLoading" style="display: none;" class="text-center py-3">
                        <div class="spinner-border spinner-border-sm text-info me-2"></div>
                        <small>Generating suggestions...</small>
                    </div>
                </div>
            </div>

            <!-- Quick Tips Card -->
            <div class="card shadow-sm mt-3">
                <div class="card-header bg-warning text-dark">
                    <h6 class="mb-0">ðŸ’¡ Quick Tips</h6>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled mb-0 small">
                        <li class="mb-2">â€¢ Use suggestions as conversation starters</li>
                        <li class="mb-2">â€¢ Build on the child's natural interests</li>
                        <li class="mb-2">â€¢ Keep sessions interactive and engaging</li>
                        <li>â€¢ Document what sparks curiosity</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Email Modal -->
<div class="modal fade" id="emailModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Email Report</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="email-form">
                    <div class="mb-3">
                        <label for="recipient-email" class="form-label">Recipient Email</label>
                        <input type="email" class="form-control" id="recipient-email" required>
                    </div>
                    <div class="mb-3">
                        <label for="email-subject" class="form-label">Subject</label>
                        <input type="text" class="form-control" id="email-subject" value="Observation Report">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="sendEmail()">Send Email</button>
            </div>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="successToast" class="toast" role="alert">
        <div class="toast-header">
            <i class="fas fa-check-circle text-success me-2"></i>
            <strong class="me-auto">Success</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body" id="successMessage"></div>
    </div>

    <div id="errorToast" class="toast" role="alert">
        <div class="toast-header">
            <i class="fas fa-exclamation-triangle text-danger me-2"></i>
            <strong class="me-auto">Error</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
        </div>
        <div class="toast-body" id="errorMessage"></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const childSelect = document.getElementById('child_id');
    const processingModes = document.querySelectorAll('input[name="processing_mode"]');
    const fileInput = document.getElementById('file-input');
    const fileUploadArea = document.querySelector('.file-upload-area');
    const processBtn = document.getElementById('process-btn');
    const getSuggestionsBtn = document.getElementById('getSuggestionsBtn');
    const refreshSuggestionsBtn = document.getElementById('refreshSuggestionsBtn');
    const suggestionsContainer = document.getElementById('suggestionsContainer');
    const suggestionsControls = document.getElementById('suggestionsControls');
    const suggestionsLoading = document.getElementById('suggestionsLoading');

    // Show suggestion controls when child is selected
    childSelect.addEventListener('change', function() {
        if (this.value) {
            suggestionsControls.style.display = 'block';
            updateSuggestionsPlaceholder();
        } else {
            suggestionsControls.style.display = 'none';
            showDefaultSuggestionsMessage();
        }
    });

    // Get suggestions
    getSuggestionsBtn.addEventListener('click', function() {
        const childId = childSelect.value;
        if (!childId) {
            alert('Please select a child first');
            return;
        }
        fetchSuggestions(childId, false);
    });

    // Refresh suggestions
    refreshSuggestionsBtn.addEventListener('click', function() {
        const childId = childSelect.value;
        if (!childId) {
            alert('Please select a child first');
            return;
        }
        fetchSuggestions(childId, true);
    });

    function fetchSuggestions(childId, isRefresh = false) {
        suggestionsLoading.style.display = 'block';
        suggestionsContainer.innerHTML = '';

        const endpoint = isRefresh ? '/observer/refresh_suggestions' : '/observer/get_topic_suggestions';

        fetch(endpoint, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ child_id: childId })
        })
        .then(response => response.json())
        .then(data => {
            suggestionsLoading.style.display = 'none';

            if (data.success) {
                displaySuggestions(data.suggestions, data.child_name, data.data_points);
            } else {
                suggestionsContainer.innerHTML = `
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        ${data.error || 'Failed to generate suggestions'}
                    </div>
                `;
            }
        })
        .catch(error => {
            suggestionsLoading.style.display = 'none';
            suggestionsContainer.innerHTML = `
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    Network error. Please try again.
                </div>
            `;
        });
    }

    function displaySuggestions(suggestions, childName, dataPoints) {
        // Clean up the suggestions and format them properly
        let formattedSuggestions = suggestions;

        // Remove markdown formatting
        formattedSuggestions = formattedSuggestions.replace(/\*\*/g, '');

        // Split into lines and process each line
        const lines = formattedSuggestions.split('\n');
        let inList = false;
        let htmlContent = '';
        let itemCount = 0;

        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();

            // Check if this is a numbered list item (any number followed by a dot)
            if (/^\d+\./.test(line)) {
                if (!inList) {
                    htmlContent += '<ul>';
                    inList = true;
                }
                // Extract the content after the number and make the first part bold
                const content = line.replace(/^\d+\.\s*/, '');

                // Split by first period or dash to separate title from description
                const parts = content.split(/[.:-]/);
                if (parts.length > 1) {
                    const title = parts[0].trim();
                    const description = parts.slice(1).join('.').trim();
                    htmlContent += `<li><strong>${title}</strong>${description ? ': ' + description : ''}</li>`;
                } else {
                    htmlContent += `<li><strong>${content}</strong></li>`;
                }
                itemCount++;
            } else if (line === '') {
                // Empty line - close list if we're in one
                if (inList) {
                    htmlContent += '</ul>';
                    inList = false;
                }
                htmlContent += '<br>';
            } else {
                // Regular text line
                if (inList) {
                    htmlContent += '</ul>';
                    inList = false;
                }
                htmlContent += `<p>${line}</p>`;
            }
        }

        // Close any open list
        if (inList) {
            htmlContent += '</ul>';
        }

        suggestionsContainer.innerHTML = `
            <div class="suggestions-content">
                <div class="suggestions-text">
                    ${htmlContent}
                </div>
            </div>
        `;
    }

    function updateSuggestionsPlaceholder() {
        const selectedOption = childSelect.options[childSelect.selectedIndex];
        const childName = selectedOption ? selectedOption.text : 'the selected child';

        suggestionsContainer.innerHTML = `
            <div class="text-center text-muted py-3">
                <i class="fas fa-magic fa-2x mb-3"></i>
                <p>Ready to generate AI-powered topic suggestions for <strong>${childName}</strong>!</p>
                <small>Click "Get Suggestions" to see personalized ideas based on learning history.</small>
            </div>
        `;
    }

    function showDefaultSuggestionsMessage() {
        suggestionsContainer.innerHTML = `
            <div class="text-center text-muted py-4">
                <i class="fas fa-lightbulb fa-2x mb-3"></i>
                <p>Select a child to get AI-powered topic suggestions based on their learning history!</p>
            </div>
        `;
    }

    // Processing mode change handler
    processingModes.forEach(radio => {
        radio.addEventListener('change', function() {
            if (this.checked) {
                updateFileUploadArea(this.value);
                processBtn.disabled = false;
            }
        });
    });

    function updateFileUploadArea(mode) {
        const uploadSection = document.getElementById('upload-section');
        const fileTypes = document.getElementById('file-types');

        // Show the upload section
        uploadSection.style.display = 'block';

        if (mode === 'ocr') {
            fileInput.accept = '.jpg,.jpeg,.png,.gif,.bmp,.tiff';
            fileTypes.textContent = 'Images: JPG, PNG, GIF, BMP, TIFF';
        } else if (mode === 'audio') {
            fileInput.accept = '.mp3,.wav,.m4a,.ogg,.flac';
            fileTypes.textContent = 'Audio: MP3, WAV, M4A, OGG, FLAC';
        }
    }

    // File upload handling
    fileInput.addEventListener('change', function() {
        if (this.files.length > 0) {
            const file = this.files[0];
            const filePreview = document.getElementById('file-preview');
            filePreview.innerHTML = `
                <div class="alert alert-info">
                    <i class="fas fa-file me-2"></i>
                    Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)
                </div>
            `;
        }
    });

    // Set current date and time
    document.getElementById('session_date').value = new Date().toISOString().split('T')[0];
    const now = new Date();
    document.getElementById('session_start').value = now.toTimeString().slice(0,5);

    // Handle form submission
    document.getElementById('process-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const form = this;
        const processBtn = document.getElementById('process-btn');
        const originalBtnText = processBtn.innerHTML;

        // Show loading state
        processBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing...';
        processBtn.disabled = true;

        // Submit form
        fetch(form.action, {
            method: 'POST',
            body: new FormData(form)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                // Remove existing report if any
                const existingReport = document.getElementById('generated-report');
                if (existingReport) {
                    existingReport.remove();
                }

                // Create new report section
                const reportSection = document.createElement('div');
                reportSection.className = 'card mt-4 fade-in';
                reportSection.id = 'generated-report';
                reportSection.innerHTML = `
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="fas fa-file-alt me-2"></i>Generated Report</h5>
                        <div class="btn-group">
                            <a href="${data.download_urls.word}" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-download me-1"></i>Download Word
                            </a>
                            <a href="${data.download_urls.pdf}" class="btn btn-outline-danger btn-sm">
                                <i class="fas fa-file-pdf me-1"></i>Download PDF
                            </a>
                            <button class="btn btn-outline-success btn-sm" onclick="showEmailModal('regular')">
                                <i class="fas fa-envelope me-1"></i>Email
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="report-content" style="white-space: pre-wrap; background: #f8f9fa; padding: 1rem; border-radius: 8px; max-height: 500px; overflow-y: auto; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; line-height: 1.6;">
                            ${data.report}
                        </div>
                    </div>
                `;

                // Insert the new report section after the form card
                const formCard = document.querySelector('.card');
                formCard.parentNode.insertBefore(reportSection, formCard.nextSibling);

                // Scroll to report
                reportSection.scrollIntoView({ behavior: 'smooth' });
            } else {
                alert('Error: ' + data.error);
            }

            // Reset form and button
            resetForm();
            processBtn.innerHTML = originalBtnText;
            processBtn.disabled = true;
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error processing observation. Please try again.');
            processBtn.innerHTML = originalBtnText;
            processBtn.disabled = false;
        });
    });

    function resetForm() {
        // Reset the form
        document.getElementById('process-form').reset();

        // Explicitly reset child selection to default
        document.getElementById('child_id').selectedIndex = 0;

        // Explicitly uncheck all processing mode radio buttons
        const processingModes = document.querySelectorAll('input[name="processing_mode"]');
        processingModes.forEach(radio => radio.checked = false);

        // Ensure process button is disabled
        document.getElementById('process-btn').disabled = true;

        // Clear file preview and hide upload section
        document.getElementById('file-preview').innerHTML = '';
        document.getElementById('upload-section').style.display = 'none';
        document.getElementById('file-types').textContent = 'Select a processing mode first';
    }

    // Custom report generation
    function generateCustomReport() {
        const childId = document.getElementById('custom-child-select').value;
        const prompt = document.getElementById('custom-prompt').value;

        if (!childId || !prompt.trim()) {
            alert('Please select a child and enter a prompt');
            return;
        }

        // Show loading
        const button = event.target;
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Generating...';
        button.disabled = true;

        const formData = new FormData();
        formData.append('child_id', childId);
        formData.append('prompt', prompt);

        fetch('/observer/custom_report', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Display the custom report with download buttons
                document.getElementById('custom-report-content').textContent = data.report;
                document.getElementById('custom-report-section').style.display = 'block';
                document.getElementById('custom-report-section').classList.add('fade-in');

                // Scroll to the report
                document.getElementById('custom-report-section').scrollIntoView({ behavior: 'smooth' });
            } else {
                alert('Error generating report: ' + data.error);
            }
        })
        .catch(error => {
            alert('Error generating report');
            console.error('Error:', error);
        })
        .finally(() => {
            button.innerHTML = originalText;
            button.disabled = false;
        });
    }

    // Download custom reports
    function downloadCustomReport(type) {
        const url = type === 'word' ? '/observer/download_custom_report' : '/observer/download_custom_pdf';
        window.open(url, '_blank');
    }

    // Email custom report
    function emailCustomReport() {
        showEmailModal('custom');
    }

    // Email modal functions
    function showEmailModal(reportType = 'regular') {
        const modal = document.getElementById('emailModal');
        if (modal) {
            modal.setAttribute('data-report-type', reportType);
            const bootstrapModal = new bootstrap.Modal(modal);
            bootstrapModal.show();
        }
    }

    function sendEmail() {
        const email = document.getElementById('recipient-email').value;
        const modal = document.getElementById('emailModal');
        const reportType = modal ? modal.getAttribute('data-report-type') || 'regular' : 'regular';

        if (!email) {
            alert('Please enter an email address');
            return;
        }

        const formData = new FormData();
        formData.append('recipient_email', email);

        let endpoint = '/observer/email_report';
        if (reportType === 'custom') {
            endpoint = '/observer/email_custom_report';
        }

        fetch(endpoint, {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Email sent successfully!');
                bootstrap.Modal.getInstance(modal).hide();
            } else {
                alert('Error sending email: ' + data.error);
            }
        })
        .catch(error => {
            alert('Error sending email');
            console.error('Error:', error);
        });
    }
});
</script>

<style>
.suggestions-content {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.suggestions-text {
    background: #f8f9fa;
    padding: 1.5rem;
    border-radius: 12px;
    border-left: 4px solid #17a2b8;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
}

.suggestions-text ul {
    padding-left: 1.5rem;
    margin-bottom: 0;
    list-style-type: disc;
}

.suggestions-text li {
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid #e9ecef;
    line-height: 1.6;
}

.suggestions-text li:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.suggestions-text h1,
.suggestions-text h2,
.suggestions-text h3,
.suggestions-text h4,
.suggestions-text h5,
.suggestions-text h6 {
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 0.5rem;
    font-size: 1.2em;
}

.suggestions-text strong {
    color: #2c3e50;
    font-weight: 700;
    font-size: 1.1em;
}

.suggestions-text p {
    margin-top: 0.5rem;
    margin-bottom: 0;
    color: #495057;
    font-size: 0.95em;
}

.suggestions-text h1,
.suggestions-text h2,
.suggestions-text h3,
.suggestions-text h4,
.suggestions-text h5,
.suggestions-text h6 {
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 0.5rem;
}

.suggestions-text strong {
    font-weight: bold;
    color: #2c3e50;
}

.file-upload-area {
    border: 2px dashed #ddd;
    border-radius: 8px;
    padding: 40px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.file-upload-area:hover {
    border-color: #007bff;
    background-color: #f8f9fa;
}

.file-upload-area.dragover {
    border-color: #28a745;
    background-color: #d4edda;
}

.report-content {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.fade-in {
    animation: fadeIn 0.5s ease-in;
}

@media (max-width: 768px) {
    .col-lg-4 {
        margin-top: 1rem;
    }
}
</style>
{% endblock %}
